FROM ubuntu:20.04

SHELL ["/bin/bash", "-c"]

WORKDIR /application

RUN apt-get update \
    && apt-get install -y software-properties-common sshfs \
    && mkdir -p /root/.ssh \
    && echo $'-----BEGIN OPENSSH PRIVATE KEY-----\
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\
-----END OPENSSH PRIVATE KEY-----' > /root/.ssh/id_rsa \
    && chmod 700 /root/.ssh/id_rsa \
    && mkdir dirprueba

COPY fmmain_server ./

EXPOSE 8081

CMD ["pwd && sshfs -o StrictHostKeyChecking=no storage@ip-10-2-3-91.ec2.internal:/home/storage/dirprueba ./dirprueba && ./fmmain_server"]